import numpy as np
import matplotlib.pyplot as plt

def F0T_gas(T): # Расчет приведенной энергии Гиббса для газа при температуре Т
    x = T * 1e-4
    return 261.047321 + 30.6373513 * np.log(x) - 0.000281369 * (1.0 / (x * x)) \
           + 0.015643651 * (1.0 / x) + 63.174977293 * x - 24.0775730439 * x * x + 4.1166014 * x * x * x

def F0T_water(T): # Расчет приведенной энергии Гиббса для воды при температуре Т
    x = T
    return -61.53274 + 17.64285 * np.log(x) - 823.02681312 * (1.0 / (x * x)) + 351.948940 * (1.0 / x) \
           - 0.205265594 * x + 0.0006830665 * x * x - 0.0000005178652 * x * x * x

def G0T_gas(T): # Расчёт свободной энергии Гиббса для газа при температуре T (в Кельвинах)
    x = T
    return (-241.820 * 1000) - (9.908 * 1000) - x * F0T_gas(x)

def G0T_liquid(T): # Расчёт свободной энергии Гиббса для жидкости при температуре T (в Кельвинах)
    x = T
    return (-285.83 * 1000) - (13.273 * 1000) - x * F0T_water(x)

def P_approximation(T):
    P0 = 101325 # стандартное атмосферное давление в Па
    R = 8.3144598 # универсальная газовая постоянная
    return P0 * np.exp((G0T_liquid(T) - G0T_gas(T)) / (R * T))

# Константы для уравнения Антуана (для воды)
# Уравнение валидно для диапазона температур от 1°C до 100°C
A = 8.07131
B = 1730.63
C = 233.426

# Диапазон температур (в градусах Цельсия)
T_C = np.linspace(1, 100, 500)  # Температура в диапазоне от 1 до 100 °C
T_K = T_C + 273.15  # Конвертация температуры в Кельвины

# Расчёт давления по двум методам
P_approximation_values = [P_approximation(T) for T in T_K]  # Давление по аппроксимации
P_approximation_kPa = np.array(P_approximation_values) / 1000  # Конвертация давления в кПа

P_antoine_mmHg = 10 ** (A - B / (T_C + C))  # Давление по уравнению Антуана (мм рт. ст.)
P_antoine_kPa = P_antoine_mmHg * 0.133322  # Конвертация мм рт. ст. в кПа

# Построение графика для сравнения
plt.figure(figsize=(10, 6))
plt.plot(T_K, P_approximation_kPa, label="P(T) (аппроксимация)", color="red")  # График по аппроксимации
plt.plot(T_K, P_antoine_kPa, label="P(T) (Уравнение Антуана)", color="blue") # График по уравнению Антуана
plt.title("Сравнение кривых насыщенного давления", fontsize=14) # Заголовок графика
plt.xlabel("Температура, K", fontsize=12) # Ось X (температура в Кельвинах)
plt.ylabel("Давление, кПа", fontsize=12) # Ось Y (давление в кПа)
plt.grid(True) # Добавление сетки на график
plt.legend(fontsize=12) # Легенда для графика
plt.show()